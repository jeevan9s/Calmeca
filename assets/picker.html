<script type="text/javascript">
  let oauthToken = null;

  function onApiLoad() {
    gapi.load('picker', { callback: createPicker });
  }

  function createPicker() {
    if (oauthToken) {
      const picker = new google.picker.PickerBuilder()
        .addView(google.picker.ViewId.DOCS)
        .setOAuthToken(oauthToken)
        .setDeveloperKey(YOUR_API_KEY)
        .setCallback(pickerCallback)
        .build();
      picker.setVisible(true);
    }
  }

  function pickerCallback(data) {
    if (data.action === google.picker.Action.PICKED) {
      const file = data.docs[0];
      window.postMessage({ type: 'PICKED_FILE', fileId: file.id }, '*');
    }
  }
</script>
<script src="https://apis.google.com/js/api.js?onload=onApiLoad"></script>
